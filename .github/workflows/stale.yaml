---
# yaml-language-server: $schema=https://json.schemastore.org/github-workflow.json
name: Stale

on:
  schedule:
    - cron: "30 1 * * *"
  workflow_dispatch:

permissions:
  contents: read

jobs:
  stale:
    name: Stale
    runs-on: ubuntu-latest
    permissions:
      actions: write
      contents: write
      issues: write
      pull-requests: write
    steps:
      - name: Generate Token
        uses: actions/create-github-app-token@def152b8a737443d7af6c5722c6389146fe90c90 # v2.1.2
        id: app-token
        with:
          app-id: "${{ secrets.LAB_ASSISTANT_APP_ID }}"
          private-key: "${{ secrets.LAB_ASSISTANT_APP_KEY }}"

      - name: Stale
        uses: actions/stale@3a9db7e6a41a89f618792c92c0e97cc736e1b13f # v10.0.0
        with:
          repo-token: ${{ steps.app-token.outputs.token }}
          stale-issue-message: |
            This issue has been marked as stale due to 60 days of inactivity. Please remove the stale label or leave a comment to keep it open.
            If no action is taken, it will be automatically closed in 7 days.
          stale-pr-message: |
            This pull request has been marked as stale due to 60 days of inactivity. Please remove the stale label or leave a comment to prevent it from being closed.
            If no action is taken, it will be automatically closed in 7 days.
          close-issue-message: |
            This issue has been automatically closed after 7 days of inactivity following the stale status.
          close-pr-message: |
            This pull request has been automatically closed after 7 days of inactivity following the stale status.
          stale-issue-label: stale
          stale-pr-label: stale
          delete-branch: true
